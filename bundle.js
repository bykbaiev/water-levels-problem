(()=>{"use strict";const e=[{landscape:[4,1,5,2,4,9,8,7,6,8],time:1,result:[0,2.5,0,2.5,.5,0,.375,1.375,2.375,.375]},{landscape:[1,2,3,4,1],time:1,result:[2.16667,1.16667,.16667,0,1.5]},{landscape:[1,2,3,4,1],time:2,result:[3.2,2.2,1.2,.2,3.2]},{landscape:[4,1,5,2,4,9,8,7,6,8],time:2,result:[1.8,4.8,.8,3.8,1.8,0,1,2,3,1]},{landscape:[3,1,6,4,8,9],time:1,result:[1,3,0,2,0,0]},{landscape:[3,1,6,4,8,9],time:2,result:[3.5,5.5,.5,2.5,0,0]},{landscape:[3,1,6,4,8,9],time:3,result:[5,7,2,4,0,0]}];var t,r,n,i=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var u=arguments[t],l=0,a=u.length;l<a;l++,i++)n[i]=u[l];return n},u="#landscapeEl",l="#time",a="#error",h="#result",c=1e3,f=500,o=("div",function(e,t){var r=document.createElement("div");return Object.keys(e).map((function(t){return r.setAttribute(t,e[t])})),t.map((function(e){return r.appendChild(e)})),r}),s=function(e){return document.createTextNode(e)},d=function(e){return Number(e.toFixed(3)).toString()},g=function(e){var t=Math.ceil(e/25);return{diff:t,items:Array(e).fill(0).map((function(e,t){return t})).filter((function(e){return e%t==0}))}},p=function(e,t){var r=g(e),n=r.items,i=r.diff;return n.map((function(e){return o({class:"ruler-item",style:"height:"+t*i+"px"},[o({class:"ruler-number"},[s(e.toString())])])}))},v=function(e){var t=document.querySelector("#landscape");t.innerHTML="",t.append(function(e){var t=e.length,r=Math.max.apply(Math,e.map((function(e){return e.height+e.water})));if(0===t)return o({class:"empty",style:"width: 1000px; height: 500px; line-height: 500px;"},[s("Please provide the landscape")]);var n,u,l=Math.ceil(1.3*r),a=f/l,h=(n=c/t,u=a,function(e){var t=e.height,r=e.water;return o({class:"segment",style:"width:"+n+"px"},[o({class:"total"},[s(d(t+r))]),o({class:"water",style:"height: "+r*u+"px"},[]),o({class:"ground",style:"height: "+t*u+"px"},[]),o({class:"water-level"},[s(d(r))])])});return o({class:"board-wrapper",style:"width: 1000px; height: 500px;"},i(function(e,t){var r=g(e),n=r.items,i=r.diff;return n.map((function(){return o({class:"line",style:"height:"+t*i+"px"},[])}))}(l,a),[o({class:"board"},i(e.map(h),[o({class:"ruler"},p(l,a))]))]))}(e))},m=function(e){document.querySelector(a).innerHTML=e},x=function(){return(x=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var u=arguments[t],l=0,a=u.length;l<a;l++,i++)n[i]=u[l];return n},S=function(e){return e.reduce((function(e,t){return y([t],e)}),[])},q=function(e){var t=[{height:1/0,index:-1}];return e.reduce((function(e,r,n){for(var i=[];r>=t[t.length-1].height;)i.unshift(t.pop());var u=i.reduce((function(n,u,l){var a=u.height,h=u.index,c=0===l?t[t.length-1]:i[l-1],f=(r-a)*(h-c.index);return n+e[h]+f}),0);return t.push({height:r,index:n}),y(e,[u])}),[])},L=function(e,t){var r=[{height:1/0,index:-1}];return e.reduce((function(e,n,i){for(var u=null;t(n,r[r.length-1].height);)u=r.pop();var l=u?{index:u.index,square:i-r[r.length-1].index-1}:{index:-1,square:0};return r.push({height:n,index:i}),y(e,[l])}),[])},D=function(e,t,r,n,i){var u,l;if(0===e.length||-1===n)return null;if(1===e.length){var a=e[0];return x(x({},a),{isLeftChild:i,left:null,right:null,leftSquare:0,rightSquare:0})}var h=t[n],c=r[n];return x(x({},e[n]),{isLeftChild:i,leftSquare:(null==h?void 0:h.square)||0,rightSquare:(null==c?void 0:c.square)||0,left:D(e,t,r,null!==(u=null==h?void 0:h.index)&&void 0!==u?u:-1,!0),right:D(e,t,r,null!==(l=null==c?void 0:c.index)&&void 0!==l?l:-1,!1)})},b=function(e){return e?y(b(e.left),[{height:e.height,index:e.index}],b(e.right)):[]},E=function(e,t){return e?x(x({},e),{height:t,left:E(e.left,t),right:E(e.right,t)}):e},M=function(e,t,r){if(!e)return null;var n=1*r,i=n+t,u=e.leftSquare*n,l=e.rightSquare*n,a=!0===e.isLeftChild,h=!1===e.isLeftChild,c=!e.isLeftChild&&!h;if(n+u+l>=e.leftDeficit+e.rightDeficit-t)return E(e,e.height+(i+l+u-e.leftDeficit-e.rightDeficit)/(e.leftSquare+e.rightSquare+1));var f=n/2,o=e.leftDeficit-u-f,s=e.rightDeficit-l-f;return x(x({},e),c&&o>=0&&s>=0?{left:M(e.left,f,r),right:M(e.right,f,r)}:a&&o>=0&&s-t>=0?{left:M(e.left,f,r),right:M(e.right,t+f,r)}:h&&o-t>=0&&s>=0?{left:M(e.left,t+f,r),right:M(e.right,f,r)}:c&&o<0?{left:E(e.left,e.height),right:M(e.right,n-(e.leftDeficit-u),r)}:c&&s<0?{left:M(e.left,n-(e.rightDeficit-l),r),right:E(e.right,e.height)}:a&&o<0?{left:E(e.left,e.height),right:M(e.right,i-(e.leftDeficit-u),r)}:a&&s-t<0?{left:M(e.left,i-(e.rightDeficit-l),r),right:E(e.right,e.height)}:h&&s<0?{right:E(e.right,e.height),left:M(e.left,i-(e.rightDeficit-l),r)}:{left:E(e.left,e.height),right:M(e.left,i-(e.leftDeficit-u),r)})};t=function(e,t){var r=e.split(",").map((function(e){return parseFloat(e)})),n=parseFloat(t);if(r.some((function(e){return isNaN(e)||e<0})))m("There is invalid landscape: every segment should be valid positive number");else if(isNaN(n)||n<0)m("There is invalid time period: it should be positive");else{var i,u=function(e,t){if(0===e.length)return[];var r=function(e){var t=q(e),r=function(e){return S(q(S(e)))}(e),n=function(e){return L(e,(function(e,t){return e>=t}))}(e),i=function(e){return S(L(S(e),(function(e,t){return e>t})).map((function(t){return-1===t.index?t:x(x({},t),{index:e.length-t.index-1})})))}(e),u=e.reduce((function(e,t,r){return t>e.height?{index:r,height:t}:e}),{index:-1,height:-1}).index;return D(e.map((function(e,n){return{height:e,leftDeficit:t[n],rightDeficit:r[n],index:n}})),n,i,u,null)}(e),n=M(r,0,t);return b(n).map((function(t){var r=t.height,n=t.index;return r-e[n]}))}(r,n);v(r.map((function(e,t){return{height:e,water:u[t]}}))),i="\n    LANDSCAPE:"+r.join(", ")+"\n    <br/>\n    TIME:"+t+"\n    <br/>\n    WATER LEVELS: "+u.map((function(e){return Number(e.toFixed(3))})).join(", ")+"\n    ",document.querySelector(h).innerHTML=i}},r=function(){document.querySelector(a).innerHTML="",document.querySelector(h).innerHTML="",t(document.querySelector(u).value,document.querySelector(l).value)},n=function(e){"Enter"===e.key&&r()},document.querySelector("#start").addEventListener("click",r),document.querySelector(u).addEventListener("keypress",n),document.querySelector(l).addEventListener("keypress",n),document.querySelector("#startRandom").addEventListener("click",(function(){var r=Math.round(Math.random()*e.length),n=e[r],i=n.landscape,u=n.time;t(i.join(","),u.toString())})),v([])})();